#include <cstdio>
#include <cctype>
#include <cstring>
using namespace std;
FILE *f=fopen("amestec.in","r");
FILE *g=fopen("amestec.out","w");
int T[105][105],N,K,i,j,p,ho[105],ve[105],nr,l,d;
char c;
char S[105];
bool t;
int main()
{
    fscanf(f,"%d %d\n",&N,&K);
    for(i=1;i<=N;i++)
    {
        for(j=1;j<=N;j++)
        {
            c=fgetc(f);
            if(c=='1')
            {ho[i]++;ve[j]++;T[i][j]=1;}
        }
        fscanf(f,"\n");
    }
    for(p=1;p<=K;p++)
    {
        fgets(S+1,105,f);
        j=1;
        nr=0;
        while(isdigit(S[j]))
        {nr*=10;nr+=S[j]-'0';j++;}
        c=S[j];
        t=S[j+1]-'0';
        if((c=='N'&&t)||(c=='S'&&!t))
        {
            for(j=1;j<=N;j++)
            if(nr>=N-1)
            {
                   for(i=1;i<=ve[j];i++)
                   {
                       if(!T[i][j])
                       {
                           T[i][j]=1;
                           ho[i]++;

                       }
                   }
                   for(i=ve[j]+1;i<=N;i++)
                   {
                       if(T[i][j])
                       {
                          T[i][j]=0;
                          ho[i]--;
                       }
                   }
            }
            else
            {
                for(d=1;d<=nr;d++)
                    {
                        i=1;
                        while(i<N)
                        {
                            if(!T[i][j]&&T[i+1][j])
                            {
                                T[i][j]=1;
                                T[i+1][j]=0;
                                ho[i+1]--;
                                ho[i]++;
                                i+=2;
                            }
                            else
                                i++;
                        }
                    }
            }
        }
        else if((c=='E'&&t)||(c=='V'&&!t))
        {
             for(i=1;i<=N;i++)
            if(nr>=N-1)
            {
                    for(j=N-ho[i]+1;j<=N;j++)
                    {
                        if(!T[i][j])
                       {
                           T[i][j]=1;
                           ve[j]++;

                       }
                    }
                    for(j=1;j<=ho[i];j++)
                    {
                        if(T[i][j])
                        {
                            T[i][j]=0;
                            ve[j]--;
                        }
                    }
            }
            else
            {
                for(d=1;d<=nr;d++)
                {
                        j=1;
                        while(j<N)
                        {
                            if(T[i][j]&&!T[i][j+1])
                            {
                                T[i][j+1]=1;ve[j+1]++;
                                T[i][j]=0;ve[j]--;
                                j+=2;
                            }
                            else
                                j++;
                        }
                }
            }
        }
        else if((c=='S'&&t)||(c=='N'&&!t))
        {
             for(j=1;j<=N;j++)
            if(nr>=N-1)
            {
                   for(i=1;i<=N-ve[j];i++)
                   {
                       if(T[i][j])
                       {
                           T[i][j]=0;
                           ho[i]--;

                       }
                   }
                   for(i=N-ve[j]+1;i<=N;i++)
                   {
                       if(!T[i][j])
                       {
                          T[i][j]=1;
                          ho[i]++;
                       }
                   }
            }
            else
            {
                for(d=1;d<=nr;d++)
                    {
                        i=1;
                        while(i<N)
                        {
                            if(T[i][j]&&!T[i+1][j])
                            {
                                T[i][j]=0;
                                T[i+1][j]=1;
                                ho[i+1]++;
                                ho[i]--;
                                i+=2;
                            }
                            else
                                i++;
                        }
                    }
            }
        }
        else
        {
            if(nr>=N-1)
            {
                {
                    for(j=1;j<=ho[i];j++)
                    {
                        if(!T[i][j])
                       {
                           T[i][j]=1;
                           ve[j]++;

                       }
                    }
                    for(j=ho[i]+1;j<=N;j++)
                    {
                        if(T[i][j])
                        {
                            T[i][j]=0;
                            ve[j]--;
                        }
                    }
                }
            }
            else
            {
                for(d=1;d<=nr;d++)
                {
                    for(i=1;i<=N;i++)
                    {
                        j=1;
                        while(j<N)
                        {
                            if(!T[i][j]&&T[i][j+1])
                            {
                                T[i][j+1]=0;ve[j+1]--;
                                T[i][j]=1;ve[j]++;
                                j+=2;
                            }
                            else
                                j++;
                        }
                    }
                }
            }
        }
    }
    for(i=1;i<=N;i++)
    {
        for(j=1;j<=N;j++)
        {
            fprintf(g,"%d",T[i][j]);
        }
        fprintf(g,"\n");
    }
    fclose(f);
    fclose(g);
    return 0;
}
